---
title: "XSSはサニタイジングで無効化"
emoji: "💊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [XSS, セキュリティ,php]
published: true
---

## XSSとは

HTMLの中に悪意のあるJavaScriptの構文を入れることで不正な動作を引き起こさせる攻撃手法です。JavaScriptの構文を使っているので、ブラウザで実行させることができます。
フォームに入力した値をそのまま出力している場合、狙われやすいので対策が必要です。

何も対策をしなかった場合、たとえば入力欄に下記スクリプトを入れると、開発者が意図しないスクリプトが実行されてしまいます。
```js
<script>alert("This is XSS")</script>
```
## 対策

**サニタイジング**と呼ばれる処理をして「'」といった特殊な文字をJSの構文ではなく、普通の文字として認識するように無効化します。
phpではhtmlspecialchars()という関数がある^[JavaScriptでは、サニタイジングする関数がないので自作する必要があります。]ので、積極的に利用しましょう。

```php
echo htmlspecialchars("'", ENT_QUOTES, 'UTF-8');
// 実行結果: &#039;
```

また、サニタイジングを行ったときに意図しない動作を起こさせないためにも
入力チェックをして、不正な文字を入力されないようにしてから
出力するときにサニタイジングを行いましょう。

## 参考

https://www.amazon.co.jp/%E3%80%8C%E3%83%97%E3%83%AD%E3%81%AB%E3%81%AA%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AEWeb%E6%8A%80%E8%A1%93%E5%85%A5%E9%96%80%E3%80%8D-%E2%80%95%E2%80%95%E3%81%AA%E3%81%9C%E3%80%81%E3%81%82%E3%81%AA%E3%81%9F%E3%81%AFWeb%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%82%92%E9%96%8B%E7%99%BA%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E3%81%AE%E3%81%8B-%E5%B0%8F%E6%A3%AE-%E8%A3%95%E4%BB%8B/dp/4774142352
